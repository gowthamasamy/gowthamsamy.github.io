<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Family Tree App</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
</head>
<body>
  <h1>ðŸŒ³ Family Tree App</h1>

  <div id="controls">
    <button onclick="createTree()">+ New Tree</button>
    <select id="treeSelect" onchange="switchTree()"></select>
    <button onclick="toggleView()">Toggle List/Tree View</button>
    <button onclick="exportAllJSON()">Export All Trees (JSON)</button>
    <button onclick="exportAllPDF()">Export All Trees (PDF)</button>
    <button onclick="deleteCurrentTree()">Delete Current Tree</button>
    <button onclick="openPersonModal()">+ Add Person</button>
  </div>

  <div id="listView"></div>
  <div id="treeView" style="display:none;"></div>

  <!-- Person Modal -->
  <div id="personModal" style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%); background:#fff; padding:20px; border:1px solid #333; z-index:1000;">
    <h3 id="modalTitle">Add Person</h3>
    <form id="personForm">
      <label>Name:</label><br>
      <input type="text" id="personName" required><br>

      <label>Gender:</label><br>
      <select id="personGender" required>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
      </select><br>

      <label>DOB:</label><br>
      <input type="date" id="personDOB"><br>

      <label>Status:</label><br>
      <select id="personStatus" onchange="toggleDeathDate()">
        <option value="Alive">Alive</option>
        <option value="Dead">Dead</option>
      </select><br>

      <label id="deathLabel" style="display:none;">Death Date:</label>
      <input type="date" id="personDeath" style="display:none;"><br>

      <label>Marriage Date:</label><br>
      <input type="date" id="personMarriage"><br>

      <label>Father's Kulam:</label><br>
      <input type="text" id="personKulamFather"><br>

      <label>Husband's Kulam (female only):</label><br>
      <input type="text" id="personKulamHusband"><br>

      <label>Father:</label><br>
      <select id="personFather"></select><br>

      <label>Mother:</label><br>
      <select id="personMother"></select><br>

      <label>Profile Image:</label><br>
      <input type="file" id="personImage" accept="image/*"><br>
      <button type="button" onclick="deleteProfilePic()">Delete Profile Pic</button><br><br>

      <button type="submit">Save</button>
      <button type="button" onclick="closePersonModal()">Cancel</button>
    </form>
  </div>

  <!-- Relation Modal -->
  <div id="relationModal" style="display:none; position:fixed; top:30%; left:50%; transform:translateX(-50%); background:#fff; padding:20px; border:1px solid #333; z-index:1000;">
    <h3>Add Relationship</h3>
    <select id="existingPersonSelect"></select>
    <select id="relationType">
      <option value="">--Relation--</option>
      <option value="son">Son</option>
      <option value="daughter">Daughter</option>
      <option value="father">Father</option>
      <option value="mother">Mother</option>
      <option value="spouse">Spouse</option>
      <option value="half-sibling">Half-Sibling</option>
    </select>
    <button type="button" onclick="addRelationFromDropdown()">Add Relation</button>
    <button type="button" onclick="closeRelationModal()">Cancel</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>